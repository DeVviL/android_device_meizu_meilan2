To work Selinux in Enforcing mode, you need to modified system sepolicy:

---

/system/sepolicy/domain.te:

in rule

neverallow { domain -init -system_server -dumpstate userdebug_or_eng(`-qti_debugfs_domain')} debugfs:file no_rw_file_perms;

add exception '-surfaceflinger -audioserver -zygote -bootanim -cameraserver -dex2oat' to succeed

neverallow { domain -surfaceflinger -audioserver -zygote -bootanim -cameraserver -dex2oat -init -system_server -dumpstate userdebug_or_eng(`-qti_debugfs_domain')} debugfs:file no_rw_file_perms;

in rule

neverallow {
  domain
  -system_server
  -system_app
  -init
  -installd # for relabelfrom and unlink, check for this in explicit neverallow
} system_data_file:file no_w_file_perms;

add exception '-nvram_daemon -thermal_manager' to succeed

neverallow {
  domain
  -nvram_daemon
  -thermal_manager
  -system_server
  -system_app
  -init
  -installd # for relabelfrom and unlink, check for this in explicit neverallow
} system_data_file:file no_w_file_perms;

---

/system/sepolicy/netd.te:

in rules

neverallow { domain -system_server -dumpstate } netd_service:service_manager find;
neverallow { domain -system_server -dumpstate } netd:binder call;

add exception '-sysinit' to succeed

neverallow { domain -sysinit -system_server -dumpstate } netd_service:service_manager find;
neverallow { domain -sysinit -system_server -dumpstate } netd:binder call;

---
